<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Some Recommended Practices</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for misc-recs {metafor}"><tr><td>misc-recs {metafor}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Some Recommended Practices</h2>

<h3>Description</h3>

<p>This page documents some recommended practices when working with the <span class="pkg">metafor</span> package (and more generally when conducting meta-analyses). <script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</p>


<h3>Details</h3>



<h4>Restricted Maximum Likelihood Estimation</h4>

<p>When fitting models with the <code><a href="rma.uni.html">rma.uni</a></code> and <code><a href="rma.mv.html">rma.mv</a></code> functions, use of restricted maximum likelihood (REML) estimation is generally recommended. This is also the default setting (i.e., <code>method="REML"</code>). Various simulation studies have indicated that REML estimation tends to provide approximately unbiased estimates of the amount of heterogeneity (e.g., Langan et al., 2019; Veroniki et al., 2016; Viechtbauer, 2005), or more generally, of the variance components in more complex mixed-effects models (Harville, 1977).
</p>
<p>For models fitted with the <code><a href="rma.uni.html">rma.uni</a></code> function, the empirical Bayes / Paule-Mandel estimators (i.e., <code>method="EB"</code> / <code>method="PM"</code>), which can actually be shown to be identical to each other despite their different derivations (Viechtbauer et al., 2015), also have some favorable properties. However, these estimators do not generalize in a straightforward manner to more complex models, such as those that can be fitted with the <code><a href="rma.mv.html">rma.mv</a></code> function.
</p>



<h4>Improved Inference Methods</h4>

<p>When fitting models with the <code><a href="rma.uni.html">rma.uni</a></code> function, tests of individual model coefficients and the corresponding confidence intervals are by default (i.e., when <code>test="z"</code>) based on a standard normal distribution, while the omnibus test is based on a chi-square distribution. These inference methods may not perform nominally (i.e., the Type I error rate of tests and the coverage rate of confidence intervals may deviate from the chosen level), especially when the number of studies, \(k\), is low. Therefore, it is highly recommended to use the method by Hartung (1999), Sidik and Jonkman (2002), and Knapp and Hartung (2003) (the Knapp-Hartung method; also referred to as the Hartung-Knapp-Sidik-Jonkman method) by setting <code>test="knha"</code>. Then tests of individual coefficients and confidence intervals are based on a t-distribution with \(k-p\) degrees of freedom, while the omnibus test then uses an F-distribution with \(m\) and \(k-p\) degrees of freedom (with \(m\) denoting the number of coefficients tested and \(p\) the total number of model coefficients). Various simulation studies have shown that this method works very well in providing tests and confidence intervals with close to nominal performance (e.g., Sánchez-Meca &amp; Marín-Martínez, 2008; Viechtbauer et al., 2015).
</p>
<p>Alternatively, one can also conduct permutation tests using the <code><a href="permutest.html">permutest</a></code> function. These also perform very well (and are, in a certain sense, &lsquo;exact&rsquo; tests), but are computationally quite demanding.
</p>
<p>For models fitted with the <code><a href="rma.mv.html">rma.mv</a></code> and <code><a href="rma.glmm.html">rma.glmm</a></code> functions, the Knapp-Hartung method and permutation tests are not available. Instead, one can set <code>test="t"</code> to also use t- and F-distributions for making inferences (although this does not involve the adjustment to the standard errors of the estimated model coefficients that is made as part of the Knapp-Hartung method). For <code><a href="rma.mv.html">rma.mv</a></code>, one should also set <code>dfs="contain"</code>, which uses an improved method for approximating the degrees of freedom of the t- and F-distributions.
</p>
<p>Note that <code>test="z"</code> is the default for the <code><a href="rma.uni.html">rma.uni</a></code>, <code><a href="rma.mv.html">rma.mv</a></code>, and the <code><a href="rma.glmm.html">rma.glmm</a></code> functions. While the improved inference methods described above should ideally be the default, changing this now would break backwards compatibility.
</p>



<h4>General Workflow for Meta-Analyses Involving Complex Dependency Structures</h4>

<p>Many meta-analyses involve observed outcomes / effect size estimates that cannot be assumed to be independent, because some estimates were computed based on the same sample of subjects (or at least a partially overlapping set). In this case, one should compute the covariances for any pair of estimates that involve (fully or partially) overlapping subjects. Doing so is difficult, but we can often construct an approximate variance-covariance matrix (say \(V\)) of such dependent estimates. This can be done with the <code><a href="vcalc.html">vcalc</a></code> function. We can then fit a multivariate/multilevel model to the estimates with the <code><a href="rma.mv.html">rma.mv</a></code> function, using \(V\) as the approximate var-cov matrix of the estimates and adding fixed and random effects to the model as deemed necessary. However, since \(V\) is often just a rough approximation (and since the random effects structure may not fully capture all dependencies in the underlying true outcomes/effects), we can then apply cluster-robust inference methods (also known as robust variance estimation) to the model. This can be done with the <code><a href="robust.html">robust</a></code> function, which also interfaces with the improved inference methods implemented in the <a href="https://cran.r-project.org/package=clubSandwich">clubSandwich</a> package to obtain the cluster-robust tests and confidence intervals.\(^1\) Finally, we can compute predicted outcomes (with corresponding confidence intervals) and test sets of coefficients or linear combinations thereof using the <code><a href="predict.rma.html">predict</a></code> and <code><a href="anova.rma.html">anova</a></code> functions. See Pustejovsky and Tipton (2022) for a paper describing such a workflow for various cases.
</p>
<p>To summarize, the general workflow therefore will often consist of these steps:
</p>
<pre># construct/approximate the var-cov matrix of dependent estimates
V &lt;- vcalc(...)

# fit multivariate/multilevel model with appropriate fixed/random effects
res &lt;- rma.mv(yi, V, mods = ~ ..., random = ~ ...)

# apply cluster-robust inference methods (robust variance estimation)
# note: use the improved methods from the clubSandwich package
sav &lt;- robust(res, cluster = ..., clubSandwich = TRUE)
sav

# compute predicted outcomes (with corresponding CIs) as needed
predict(sav, ...)

# test sets of coefficients / linear combinations as needed
anova(sav, ...)</pre>
<p>The details of how <code><a href="vcalc.html">vcalc</a></code> and <code><a href="rma.mv.html">rma.mv</a></code> are used (and the clustering variable specified for <code><a href="robust.html">robust</a></code>) will depend on the specifics of the application.
</p>
<p>See <code><a href="../../metadat/html/dat.knapp2017.html">dat.knapp2017</a></code> and <code><a href="../../metadat/html/dat.tannersmith2016.html">dat.tannersmith2016</a></code> for some examples illustrating this workflow.
</p>



<h4>Profile Likelihood Plots to Check Parameter Identifiability</h4>

<p>When fitting complex models, it is not guaranteed that all parameters of the model are identifiable (i.e., that there is a unique set of values for the parameters that maximizes the (restricted) likelihood function). For models fitted with the <code><a href="rma.mv.html">rma.mv</a></code> function, this pertains especially to the variance/correlation components of the model (i.e., what is specified via the <code>random</code> argument). Therefore, it is strongly advised in general to do post model fitting checks to make sure that the likelihood surface around the ML/REML estimates is not flat for some combination of the parameter estimates (which would imply that the estimates are essentially arbitrary). For example, one can plot the (restricted) log-likelihood as a function of each variance/correlation component in the model to make sure that each profile plot shows a clear peak at the corresponding ML/REML estimate. The <code><a href="profile.rma.html">profile</a></code> function can be used for this purpose. See also Raue et al. (2009) for some further discussion of parameter identifiability and the use of profile likelihoods to check for this.
</p>
<p>The <code><a href="profile.rma.html">profile</a></code> function should also be used after fitting location-scale models with the <code><a href="rma.uni.html">rma.uni</a></code> function and after fitting selection models with the <code><a href="selmodel.html">selmodel</a></code> function.
</p>

<p>&mdash;&mdash;&mdash;
</p>
<p>\(^1\) In small meta-analyses, the (denominator) degrees of freedom for the approximate t- and F-tests provided by the cluster-robust inference methods might be very low, in which case the tests may not be trustworthy and overly conservative (Joshi et al., in press). Under these circumstances, one can consider the use of cluster wild bootstrapping (as implemented in the <a href="https://cran.r-project.org/package=wildmeta">wildmeta</a> package) as an alternative method for making inferences.
</p>


<h3>Author(s)</h3>

<p>Wolfgang Viechtbauer <a href="mailto:wvb@metafor-project.org">wvb@metafor-project.org</a> <a href="https://www.metafor-project.org">https://www.metafor-project.org</a>
</p>


<h3>References</h3>

<p>Hartung, J. (1999). An alternative method for meta-analysis. <em>Biometrical Journal</em>, <b>41</b>(8), 901&ndash;916. <code style="white-space: pre;">https://doi.org/10.1002/(SICI)1521-4036(199912)41:8&lt;901::AID-BIMJ901&gt;3.0.CO;2-W</code>
</p>
<p>Harville, D. A. (1977). Maximum likelihood approaches to variance component estimation and to related problems. <em>Journal of the American Statistical Association</em>, <b>72</b>(358), 320&ndash;338. <code style="white-space: pre;">https://doi.org/10.2307/2286796</code>
</p>
<p>Joshi, M., Pustejovsky, J. E., &amp; Beretvas, S. N. (in press). Cluster wild bootstrapping to handle dependent effect sizes in meta-analysis with a small number of studies. <em>Research Synthesis Methods</em>. <code style="white-space: pre;">https://doi.org/10.1002/jrsm.1554</code>
</p>
<p>Knapp, G., &amp; Hartung, J. (2003). Improved tests for a random effects meta-regression with a single covariate. <em>Statistics in Medicine</em>, <b>22</b>(17), 2693&ndash;2710. <code style="white-space: pre;">https://doi.org/10.1002/sim.1482</code>
</p>
<p>Langan, D., Higgins, J. P. T., Jackson, D., Bowden, J., Veroniki, A. A., Kontopantelis, E., Viechtbauer, W. &amp; Simmonds, M. (2019). A comparison of heterogeneity variance estimators in simulated random-effects meta-analyses. <em>Research Synthesis Methods</em>, <b>10</b>(1), 83&ndash;98. https://doi.org/10.1002/jrsm.1316
</p>
<p>Pustejovsky, J. E. &amp; Tipton, E. (2022). Meta-analysis with robust variance estimation: Expanding the range of working models. <em>Prevention Science</em>, <b>23</b>, 425&ndash;438. <code style="white-space: pre;">https://doi.org/10.1007/s11121-021-01246-3</code>
</p>
<p>Raue, A., Kreutz, C., Maiwald, T., Bachmann, J., Schilling, M., Klingmuller, U., &amp; Timmer, J. (2009). Structural and practical identifiability analysis of partially observed dynamical models by exploiting the profile likelihood. <em>Bioinformatics</em>, <b>25</b>(15), 1923&ndash;1929. <code style="white-space: pre;">https://doi.org/10.1093/bioinformatics/btp358</code>
</p>
<p>Sánchez-Meca, J. &amp; Marín-Martínez, F. (2008). Confidence intervals for the overall effect size in random-effects meta-analysis. <em>Psychological Methods</em>, <b>13</b>(1), 31&ndash;48. <code style="white-space: pre;">https://doi.org/10.1037/1082-989x.13.1.31</code>
</p>
<p>Sidik, K. &amp; Jonkman, J. N. (2002). A simple confidence interval for meta-analysis. <em>Statistics in Medicine</em>, <b>21</b>(21), 3153&ndash;3159. <code style="white-space: pre;">https://doi.org/10.1002/sim.1262</code>
</p>
<p>Veroniki, A. A., Jackson, D., Viechtbauer, W., Bender, R., Bowden, J., Knapp, G., Kuss, O., Higgins, J. P., Langan, D., &amp; Salanti, G. (2016). Methods to estimate the between-study variance and its uncertainty in meta-analysis. <em>Research Synthesis Methods</em>, <b>7</b>(1), 55&ndash;79. <code style="white-space: pre;">https://doi.org/10.1002/jrsm.1164</code>
</p>
<p>Viechtbauer, W. (2005). Bias and efficiency of meta-analytic variance estimators in the random-effects model. <em>Journal of Educational and Behavioral Statistics</em>, <b>30</b>(3), 261&ndash;293. <code style="white-space: pre;">https://doi.org/10.3102/10769986030003261</code>
</p>
<p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1&ndash;48. <code style="white-space: pre;">https://doi.org/10.18637/jss.v036.i03</code>
</p>
<p>Viechtbauer, W., López-López, J. A., Sánchez-Meca, J., &amp; Marín-Martínez, F. (2015). A comparison of procedures to test for moderators in mixed-effects meta-regression models. <em>Psychological Methods</em>, <b>20</b>(3), 360&ndash;374. <code style="white-space: pre;">https://doi.org/10.1037/met0000023</code>
</p>

<hr /><div style="text-align: center;">[Package <em>metafor</em> version 3.4-0 <a href="00Index.html">Index</a>]</div>
</body></html>
